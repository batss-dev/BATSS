<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="BATSS">
<title>Prior distributions • BATSS</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Prior distributions">
<meta property="og:description" content="BATSS">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">BATSS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.14</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <h6 class="dropdown-header" data-toc-skip>Main topics</h6>
    <a class="dropdown-item" href="../../articles/web_only/Ingredients.html">BATSS Ingredients</a>
    <a class="dropdown-item" href="../../articles/web_only/Priors.html">Prior distributions</a>
    <a class="dropdown-item" href="../../articles/web_only/Cluster.html">Cluster computation</a>
    <h6 class="dropdown-header" data-toc-skip>Examples</h6>
    <a class="dropdown-item" href="../../articles/web_only/negbin.html">Negative binomial endpoint</a>
    <a class="dropdown-item" href="../../articles/web_only/binomial.html">Binomial endpoint</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../../logo.png" class="logo" alt=""><h1>Prior distributions</h1>
            
      
      
      <div class="d-none name"><code>Priors.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://batss-dev.github.io/BATSS/" class="external-link">BATSS</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>BATSS</code> builds on integrated nested Laplace approximation
(INLA) and R-INLA, its implementation in R. INLA methodology focuses on
models that can be expressed as latent Gaussian Markov random fields
(GMRF). Consider the model</p>
<p><span class="math display">\[\eta_i = g(\mu_i) = \alpha +
\sum_{j=1}^p \beta_j z_{ij} + \sum_{k=1}^q f_{k}(u_{ik}) +
\epsilon_i\]</span></p>
<p>where</p>
<ul>
<li>
<span class="math inline">\(\eta\)</span> is the linear
predictor,</li>
<li>
<span class="math inline">\(g(.)\)</span> is the link function,</li>
<li>
<span class="math inline">\(\beta\)</span> are the <span class="math inline">\(p\)</span> coefficients for the linear effects of
covariates <span class="math inline">\(z\)</span>,</li>
<li>
<span class="math inline">\(f_{k}(.)\)</span> are the <span class="math inline">\(q\)</span> unknown functions of the covariates
<span class="math inline">\(u\)</span><br>
</li>
<li>
<span class="math inline">\(\epsilon\)</span> are unstructured
terms.</li>
</ul>
<p>Latent Gaussian models are the subset of Bayesian additive models
that assign a Gaussian prior to the latent field <span class="math inline">\(\mathcal{X}=\{\alpha, \beta, f(.)\}\)</span></p>
<p><span class="math display">\[\mathcal{X}|\theta \sim
N(0,\mathcal{Q}^{-1}(\theta))\]</span></p>
<p>where <span class="math inline">\(\mathcal{Q}\)</span> denotes the
precision matrix and <span class="math inline">\(\theta\)</span> a
vector of hyperparameters. Then the joint density of the latent field,
hyperparameters and the data is</p>
<p><span class="math display">\[ \pi(\mathcal{X},\theta|y) \propto
\pi(\theta)\pi(\mathcal{X}|\theta)\prod_{i=1}^{n}\pi(y_i|(A\mathcal{X})_i,\theta)\]</span></p>
<p>where <span class="math inline">\(\eta=A\mathcal{X}\)</span>. From
here the posterior mariginals can be approximated. Refer to <span class="citation">Rue, Martino, and Chopin (2009)</span> and <span class="citation">Van Niekerk et al. (2023)</span> for details.</p>
</div>
<div class="section level2">
<h2 id="priors-for-fixed-effects">Priors for fixed effects<a class="anchor" aria-label="anchor" href="#priors-for-fixed-effects"></a>
</h2>
<p>Hence, priors for fixed effects in INLA are normally distributed
(with a default mean <span class="math inline">\(\mu=0\)</span> and
precision <span class="math inline">\(\tau=0.001\)</span>, and since
<span class="math inline">\(\sigma^{2}=1/{\tau}\)</span>, <span class="math inline">\(N(0,\,1000)\)</span>).</p>
<p>The <code>control.fixed</code> argument of the <code>inla()</code>
function allows users to change <span class="math inline">\(\mu\)</span>
or <span class="math inline">\(\tau\)</span>. The
<code><a href="../../reference/batss.glm.html">batss.glm()</a></code> function allows control elements of the
<code>inla()</code> function to be passed on to the embedded INLA
routine via the <code>...</code> argument. <code>inla()</code>
differentiates between the intercept, <code>mean.intercept</code> and
<code>prec.intercept</code>, and all other fixed effects,
<code>mean</code> and <code>prec</code>,
e.g. <code>control.fixed = list(mean=1)</code> would assign a prior mean
of <span class="math inline">\(1\)</span> to all fixed effects but the
intercept.</p>
<p>Individual prior means or precision can be set with named lists in
the <code>control.fixed</code> argument,
e.g. <code>control.fixed = list(prec=list(A=1,B=2,default=0.1))</code>
would set the prior precision to <span class="math inline">\(1\)</span>
for fixed effect A, to <span class="math inline">\(2\)</span> for fixed
effect B and to <span class="math inline">\(0.1\)</span> for all other
fixed effects.</p>
<p>Take note that in <code>BATSS</code> nomenclature of fixed effects is
a combination of names in the right hand side of the <code>model</code>
argument and factor levels from the allocation function in the
<code>var</code> argument (which have to match the names of the vector
<code>prob0</code>) as is standard for the <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix()</a></code>
function - the first level of a factor being ignored for naming purposes
as reference level, e.g. </p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span><span class="op">)</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">treatment</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "A" "B" "C"</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">~</span> <span class="va">treatment</span></span>
<span><span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "(Intercept)" "treatmentB"  "treatmentC"</span></span></code></pre>
<p>The following example shows a <code><a href="../../reference/batss.glm.html">batss.glm()</a></code> call without
and with changes to the default prior for the fixed effects:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">efficacy.fun</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">posterior</span>,<span class="va">efficacy.bound</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">posterior</span> <span class="op">&gt;</span> <span class="va">efficacy.bound</span></span>
<span>  <span class="op">}</span></span>
<span><span class="va">group.fun</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">m</span>,<span class="va">prob</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">prob</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">prob</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">prob</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">m0.g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">prob</span><span class="op">*</span><span class="va">m</span><span class="op">)</span></span>
<span>  <span class="va">m0</span>   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">m0.g</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">prob</span><span class="op">)</span>,<span class="va">m0.g</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Multinom.html" class="external-link">rmultinom</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">m</span><span class="op">-</span><span class="va">m0</span>,<span class="va">prob</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">prob</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span> </span>
<span><span class="co">#BATSS using INLA's default normal priors, N(0,1000)</span></span>
<span><span class="va">sim1</span> <span class="op">=</span> <span class="fu"><a href="../../reference/batss.glm.html">batss.glm</a></span><span class="op">(</span>  </span>
<span>          model             <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">trt</span>,   </span>
<span>          var               <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y   <span class="op">=</span> <span class="va">rnorm</span>,</span>
<span>                                   trt <span class="op">=</span> <span class="va">group.fun</span><span class="op">)</span>,</span>
<span>          var.control       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          beta              <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>          which             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>          R                 <span class="op">=</span> <span class="fl">10</span>,</span>
<span>          N                 <span class="op">=</span> <span class="fl">200</span>,</span>
<span>          interim           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>recruited<span class="op">=</span><span class="fl">100</span><span class="op">)</span>,</span>
<span>          prob0             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>C<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, T1<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, T2<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>          eff.arm           <span class="op">=</span> <span class="va">efficacy.fun</span>,</span>
<span>          eff.arm.control   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>efficacy.bound <span class="op">=</span> <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>          delta.eff         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>          fut.arm           <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>          computation       <span class="op">=</span> <span class="st">"parallel"</span>,</span>
<span>          H0                <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          mc.cores          <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">sim1</span><span class="op">$</span><span class="va">H1</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span>,<span class="fl">3</span>,<span class="op">]</span>,<span class="fl">1</span>,<span class="va">summary</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#BATSS using normal priors with N(1,4) for the fixed effect of intervention T1 and </span></span>
<span><span class="co">#the intercept and N(0,4) for intervention T2 and all other fixed effects.</span></span>
<span><span class="va">sim2</span> <span class="op">=</span> <span class="fu"><a href="../../reference/batss.glm.html">batss.glm</a></span><span class="op">(</span>  </span>
<span>          model             <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">trt</span>,   </span>
<span>          var               <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y   <span class="op">=</span> <span class="va">rnorm</span>,</span>
<span>                                   trt <span class="op">=</span> <span class="va">group.fun</span><span class="op">)</span>,</span>
<span>          var.control       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          beta              <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>          which             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>          R                 <span class="op">=</span> <span class="fl">10</span>,</span>
<span>          N                 <span class="op">=</span> <span class="fl">200</span>,</span>
<span>          interim           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>recruited<span class="op">=</span><span class="fl">100</span><span class="op">)</span>,</span>
<span>          prob0             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>C<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, T1<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, T2<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>          eff.arm           <span class="op">=</span> <span class="va">efficacy.fun</span>,</span>
<span>          eff.arm.control   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>efficacy.bound <span class="op">=</span> <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>          delta.eff         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>          fut.arm           <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>          computation       <span class="op">=</span> <span class="st">"parallel"</span>,</span>
<span>          H0                <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          mc.cores          <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span>,</span>
<span>          control.fixed     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean.intercept<span class="op">=</span><span class="fl">1</span>,</span>
<span>                                   prec.intercept<span class="op">=</span><span class="fl">0.25</span>,</span>
<span>                                   mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trtT1 <span class="op">=</span> <span class="fl">1</span>, default <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, </span>
<span>                                   prec <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span>          <span class="op">)</span> </span>
<span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">sim2</span><span class="op">$</span><span class="va">H1</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span>,<span class="fl">3</span>,<span class="op">]</span>,<span class="fl">1</span>,<span class="va">summary</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="priors-for-hyperparameters">Priors for hyperparameters<a class="anchor" aria-label="anchor" href="#priors-for-hyperparameters"></a>
</h2>
<table class="table">
<caption>INLA hyperparameters and their default priors currently
available in <code>BATSS</code>
</caption>
<colgroup>
<col width="29%">
<col width="25%">
<col width="44%">
</colgroup>
<thead><tr class="header">
<th><strong>Distribution</strong></th>
<th><strong>Hyperparameter</strong></th>
<th><strong>Hyperparameter default prior</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>normal</td>
<td>log precision</td>
<td>log-gamma</td>
</tr>
<tr class="even">
<td>binomial</td>
<td>none</td>
<td>-</td>
</tr>
<tr class="odd">
<td>negative binomial</td>
<td>log size</td>
<td>penalised complexity gamma</td>
</tr>
<tr class="even">
<td>poisson</td>
<td>none</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>Based on INLA’s defaults, family, hyperparameter and the associated
default prior used in <code>BATSS</code> are listed in Table 1 (see
<span class="citation">Simpson et al. (2017)</span> for an in depth
description of complexity priors). Detailed information can be viewed by
typing <code>inla.models()$likelihood$[FAMILYNAME]</code> including
default parameters, e.g. for the normal distribution:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">INLA</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/INLA/man/models.html" class="external-link">inla.models</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">likelihood</span><span class="op">$</span><span class="va">gaussian</span></span></code></pre></div>
<pre><code><span><span class="co">## $doc</span></span>
<span><span class="co">## [1] "The Gaussian likelihoood"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper</span></span>
<span><span class="co">## $hyper$theta1</span></span>
<span><span class="co">## $hyper$theta1$hyperid</span></span>
<span><span class="co">## [1] 65001</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper$theta1$name</span></span>
<span><span class="co">## [1] "log precision"</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper$theta1$short.name</span></span>
<span><span class="co">## [1] "prec"</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper$theta1$output.name</span></span>
<span><span class="co">## [1] "Precision for the Gaussian observations"</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper$theta1$output.name.intern</span></span>
<span><span class="co">## [1] "Log precision for the Gaussian observations"</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper$theta1$initial</span></span>
<span><span class="co">## [1] 4</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper$theta1$fixed</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper$theta1$prior</span></span>
<span><span class="co">## [1] "loggamma"</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper$theta1$param</span></span>
<span><span class="co">## [1] 1e+00 5e-05</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper$theta1$to.theta</span></span>
<span><span class="co">## function (x) </span></span>
<span><span class="co">## log(x)</span></span>
<span><span class="co">## &lt;bytecode: 0x10cede9e0&gt;</span></span>
<span><span class="co">## &lt;environment: 0x10cedaeb0&gt;</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] TRUE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper$theta1$from.theta</span></span>
<span><span class="co">## function (x) </span></span>
<span><span class="co">## exp(x)</span></span>
<span><span class="co">## &lt;bytecode: 0x10cedeaf8&gt;</span></span>
<span><span class="co">## &lt;environment: 0x10cedaeb0&gt;</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] TRUE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper$theta2</span></span>
<span><span class="co">## $hyper$theta2$hyperid</span></span>
<span><span class="co">## [1] 65002</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper$theta2$name</span></span>
<span><span class="co">## [1] "log precision offset"</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper$theta2$short.name</span></span>
<span><span class="co">## [1] "precoffset"</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper$theta2$output.name</span></span>
<span><span class="co">## [1] "NOT IN USE"</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper$theta2$output.name.intern</span></span>
<span><span class="co">## [1] "NOT IN USE"</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper$theta2$initial</span></span>
<span><span class="co">## [1] 72.08731</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper$theta2$fixed</span></span>
<span><span class="co">## [1] TRUE</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper$theta2$prior</span></span>
<span><span class="co">## [1] "none"</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] TRUE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper$theta2$param</span></span>
<span><span class="co">## numeric(0)</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper$theta2$to.theta</span></span>
<span><span class="co">## function (x) </span></span>
<span><span class="co">## log(x)</span></span>
<span><span class="co">## &lt;bytecode: 0x10cede9e0&gt;</span></span>
<span><span class="co">## &lt;environment: 0x10cedaeb0&gt;</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] TRUE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hyper$theta2$from.theta</span></span>
<span><span class="co">## function (x) </span></span>
<span><span class="co">## exp(x)</span></span>
<span><span class="co">## &lt;bytecode: 0x10cedeaf8&gt;</span></span>
<span><span class="co">## &lt;environment: 0x10cedaeb0&gt;</span></span>
<span><span class="co">## attr(,"inla.read.only")</span></span>
<span><span class="co">## [1] TRUE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $survival</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $discrete</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $link</span></span>
<span><span class="co">## [1] "default"   "identity"  "logit"     "loga"      "cauchit"   "log"      </span></span>
<span><span class="co">## [7] "logoffset"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $pdf</span></span>
<span><span class="co">## [1] "gaussian"</span></span></code></pre>
<p>In case of the normal distribution the default prior for the
hyperparameter <span class="math inline">\(\theta=log(\tau)\)</span> is
a log-gamma distribution with parameters <span class="math inline">\(a=1\)</span> and <span class="math inline">\(b=0.00005\)</span>. To change the prior
distribution or its parameters use the <code>control.family</code>
argument of the <code>inla()</code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#BATSS using normal priors with N(1,4) for the fixed effect of intervention T1 and </span></span>
<span><span class="co">#the intercept and N(0,4) for intervention T2 and all other fixed effects and a </span></span>
<span><span class="co">#log-gamma(0.5,0.01) prior for the log precision hyperparameter.</span></span>
<span><span class="va">sim3</span> <span class="op">=</span> <span class="fu"><a href="../../reference/batss.glm.html">batss.glm</a></span><span class="op">(</span>  </span>
<span>          model             <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">trt</span>,   </span>
<span>          var               <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y   <span class="op">=</span> <span class="va">rnorm</span>,</span>
<span>                                   trt <span class="op">=</span> <span class="va">group.fun</span><span class="op">)</span>,</span>
<span>          var.control       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          beta              <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>          which             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>          R                 <span class="op">=</span> <span class="fl">10</span>,</span>
<span>          N                 <span class="op">=</span> <span class="fl">200</span>,</span>
<span>          interim           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>recruited<span class="op">=</span><span class="fl">100</span><span class="op">)</span>,</span>
<span>          prob0             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>C<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, T1<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, T2<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>          eff.arm           <span class="op">=</span> <span class="va">efficacy.fun</span>,</span>
<span>          eff.arm.control   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>efficacy.bound <span class="op">=</span> <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>          delta.eff         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>          fut.arm           <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>          computation       <span class="op">=</span> <span class="st">"parallel"</span>,</span>
<span>          H0                <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          mc.cores          <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span>,</span>
<span>          control.fixed     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean.intercept<span class="op">=</span><span class="fl">1</span>,</span>
<span>                                   prec.intercept<span class="op">=</span><span class="fl">0.25</span>,</span>
<span>                                   mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trtT1 <span class="op">=</span> <span class="fl">1</span>, default <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, </span>
<span>                                   prec <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>          control.family    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>hyper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.01</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>          <span class="op">)</span> </span>
<span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">sim3</span><span class="op">$</span><span class="va">H1</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span>,<span class="fl">3</span>,<span class="op">]</span>,<span class="fl">1</span>,<span class="va">summary</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Priors for hyperparameters can either be a built-in prior or a
user-defined function. Available predefined priors in INLA:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">INLA</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/INLA/man/list-models.html" class="external-link">inla.list.models</a></span><span class="op">(</span><span class="st">"prior"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Section [prior]</span></span>
<span><span class="co">##      betacorrelation               Beta prior for the correlation          </span></span>
<span><span class="co">##      dirichlet                     Dirichlet prior                         </span></span>
<span><span class="co">##      expression:                   A generic prior defined using expressions</span></span>
<span><span class="co">##      flat                          A constant prior                        </span></span>
<span><span class="co">##      gamma                         Gamma prior                             </span></span>
<span><span class="co">##      gaussian                      Gaussian prior                          </span></span>
<span><span class="co">##      invalid                       Void prior                              </span></span>
<span><span class="co">##      jeffreystdf                   Jeffreys prior for the doc              </span></span>
<span><span class="co">##      laplace                       Laplace prior                           </span></span>
<span><span class="co">##      linksnintercept               Skew-normal-link intercept-prior        </span></span>
<span><span class="co">##      logflat                       A constant prior for log(theta)         </span></span>
<span><span class="co">##      loggamma                      Log-Gamma prior                         </span></span>
<span><span class="co">##      logiflat                      A constant prior for log(1/theta)       </span></span>
<span><span class="co">##      logitbeta                     Logit prior for a probability           </span></span>
<span><span class="co">##      logtgaussian                  Truncated Gaussian prior                </span></span>
<span><span class="co">##      logtnormal                    Truncated Normal prior                  </span></span>
<span><span class="co">##      minuslogsqrtruncnormal        (obsolete)                              </span></span>
<span><span class="co">##      mvnorm                        A multivariate Normal prior             </span></span>
<span><span class="co">##      none                          No prior                                </span></span>
<span><span class="co">##      normal                        Normal prior                            </span></span>
<span><span class="co">##      pc                            Generic PC prior                        </span></span>
<span><span class="co">##      pc.alphaw                     PC prior for alpha in Weibull           </span></span>
<span><span class="co">##      pc.ar                         PC prior for the AR(p) model            </span></span>
<span><span class="co">##      pc.cor0                       PC prior correlation, basemodel cor=0   </span></span>
<span><span class="co">##      pc.cor1                       PC prior correlation, basemodel cor=1   </span></span>
<span><span class="co">##      pc.dof                        PC prior for log(dof-2)                 </span></span>
<span><span class="co">##      pc.fgnh                       PC prior for the Hurst parameter in FGN </span></span>
<span><span class="co">##      pc.gamma                      PC prior for a Gamma parameter          </span></span>
<span><span class="co">##      pc.gammacount                 PC prior for the GammaCount likelihood  </span></span>
<span><span class="co">##      pc.gevtail                    PC prior for the tail in the GEV likelihood</span></span>
<span><span class="co">##      pc.matern                     PC prior for the Matern SPDE            </span></span>
<span><span class="co">##      pc.mgamma                     PC prior for a Gamma parameter          </span></span>
<span><span class="co">##      pc.prec                       PC prior for log(precision)             </span></span>
<span><span class="co">##      pc.range                      PC prior for the range in the Matern SPDE</span></span>
<span><span class="co">##      pc.sn                         PC prior for the skew-normal            </span></span>
<span><span class="co">##      pc.spde.GA                    (experimental)                          </span></span>
<span><span class="co">##      pom                           #classes-dependent prior for the POM model</span></span>
<span><span class="co">##      ref.ar                        Reference prior for the AR(p) model, p&lt;=3</span></span>
<span><span class="co">##      rprior:                       A R-function defining the prior         </span></span>
<span><span class="co">##      table:                        A generic tabulated prior               </span></span>
<span><span class="co">##      wishart1d                     Wishart prior dim=1                     </span></span>
<span><span class="co">##      wishart2d                     Wishart prior dim=2                     </span></span>
<span><span class="co">##      wishart3d                     Wishart prior dim=3                     </span></span>
<span><span class="co">##      wishart4d                     Wishart prior dim=4                     </span></span>
<span><span class="co">##      wishart5d                     Wishart prior dim=5                     </span></span>
<span><span class="co">##      wishartkd                     Wishart prior</span></span></code></pre>
<p>To change a prior to one of the predefined INLA priors simply use the
<code>control.family</code> argument of the <code>inla()</code>
function. For example,
<code>control.family = list(hyper = list(prec = list(prior = "logtnormal")))</code>
will change the prior distribution of the precision to a truncated
normal prior. (Note that the name will depend on the hyperparameter,
here <code>prec</code>.)</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#BATSS with default normal priors for the fixed effects and a truncated normal prior</span></span>
<span><span class="co">#for the precision hyperparameter</span></span>
<span><span class="va">sim4</span> <span class="op">=</span> <span class="fu"><a href="../../reference/batss.glm.html">batss.glm</a></span><span class="op">(</span>  </span>
<span>          model             <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">trt</span>,   </span>
<span>          var               <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y   <span class="op">=</span> <span class="va">rnorm</span>,</span>
<span>                                   trt <span class="op">=</span> <span class="va">group.fun</span><span class="op">)</span>,</span>
<span>          var.control       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          beta              <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>          which             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>          R                 <span class="op">=</span> <span class="fl">10</span>,</span>
<span>          N                 <span class="op">=</span> <span class="fl">200</span>,</span>
<span>          interim           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>recruited<span class="op">=</span><span class="fl">100</span><span class="op">)</span>,</span>
<span>          prob0             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>C<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, T1<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, T2<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>          eff.arm           <span class="op">=</span> <span class="va">efficacy.fun</span>,</span>
<span>          eff.arm.control   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>efficacy.bound <span class="op">=</span> <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>          delta.eff         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>          fut.arm           <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>          computation       <span class="op">=</span> <span class="st">"parallel"</span>,</span>
<span>          H0                <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          mc.cores          <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span>,</span>
<span>          control.family    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>hyper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"logtnormal"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>          <span class="op">)</span> </span>
<span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">sim4</span><span class="op">$</span><span class="va">H1</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span>,<span class="fl">3</span>,<span class="op">]</span>,<span class="fl">1</span>,<span class="va">summary</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>There are two options to define priors that are not predefined in
INLA: 1. Providing a tabulated distribution via <code>table:</code></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#manually define the log-gamma prior</span></span>
<span><span class="co"># either as a 'table'</span></span>
<span><span class="va">loggamma.function</span> <span class="op">&lt;-</span>  <span class="kw">function</span><span class="op">(</span><span class="va">log_precision</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>;</span>
<span>  <span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">0.01</span>;</span>
<span>  <span class="va">precision</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">log_precision</span><span class="op">)</span>;</span>
<span>  <span class="va">logdens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">b</span><span class="op">^</span><span class="va">a</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">lgamma</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">a</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">log_precision</span> <span class="op">-</span> <span class="va">b</span><span class="op">*</span><span class="va">precision</span>;</span>
<span>  <span class="va">log_jacobian</span> <span class="op">&lt;-</span> <span class="va">log_precision</span>;</span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">logdens</span> <span class="op">+</span> <span class="va">log_jacobian</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">lprec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span>, len<span class="op">=</span><span class="fl">10000</span><span class="op">)</span></span>
<span><span class="va">loggamma.tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"table:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">lprec</span>, <span class="fu">loggamma.function</span><span class="op">(</span><span class="va">lprec</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                      sep <span class="op">=</span> <span class="st">""</span>, collapse <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span>
<span><span class="va">loggamma.table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="va">loggamma.tab</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#BATSS using normal priors with N(1,4) for the fixed effect of intervention T1 and </span></span>
<span><span class="co">#the intercept and N(0,4) for intervention T2 and all other fixed effects and a </span></span>
<span><span class="co">#tabulated log-gamma(0.5,0.01) prior for the log precision hyperparameter.</span></span>
<span><span class="va">sim5</span> <span class="op">=</span> <span class="fu"><a href="../../reference/batss.glm.html">batss.glm</a></span><span class="op">(</span>  </span>
<span>          model             <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">trt</span>,   </span>
<span>          var               <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y   <span class="op">=</span> <span class="va">rnorm</span>,</span>
<span>                                   trt <span class="op">=</span> <span class="va">group.fun</span><span class="op">)</span>,</span>
<span>          var.control       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          beta              <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>          which             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>          R                 <span class="op">=</span> <span class="fl">10</span>,</span>
<span>          N                 <span class="op">=</span> <span class="fl">200</span>,</span>
<span>          interim           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>recruited<span class="op">=</span><span class="fl">100</span><span class="op">)</span>,</span>
<span>          prob0             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>C<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, T1<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, T2<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>          eff.arm           <span class="op">=</span> <span class="va">efficacy.fun</span>,</span>
<span>          eff.arm.control   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>efficacy.bound <span class="op">=</span> <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>          delta.eff         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>          fut.arm           <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>          computation       <span class="op">=</span> <span class="st">"parallel"</span>,</span>
<span>          H0                <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          mc.cores          <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span>,</span>
<span>          control.fixed     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean.intercept<span class="op">=</span><span class="fl">1</span>,</span>
<span>                                   prec.intercept<span class="op">=</span><span class="fl">0.25</span>,</span>
<span>                                   mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trtT1 <span class="op">=</span> <span class="fl">1</span>, default <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, </span>
<span>                                   prec <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>          control.family    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>hyper <span class="op">=</span> <span class="va">loggamma.table</span><span class="op">)</span></span>
<span>          <span class="op">)</span> </span>
<span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">sim5</span><span class="op">$</span><span class="va">H1</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span>,<span class="fl">3</span>,<span class="op">]</span>,<span class="fl">1</span>,<span class="va">summary</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>or 2. providing the function via the <code>expression:</code>
statement.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#or 'expression'</span></span>
<span><span class="va">loggamma</span> <span class="op">=</span> <span class="st">"expression:</span></span>
<span><span class="st">              a = 0.5;</span></span>
<span><span class="st">              b = 0.01;</span></span>
<span><span class="st">              precision = exp(log_precision);</span></span>
<span><span class="st">              logdens = log(b^a) - lgamma(a) + (a-1)*log_precision - b*precision;</span></span>
<span><span class="st">              log_jacobian = log_precision;</span></span>
<span><span class="st">              return(logdens + log_jacobian);"</span></span>
<span><span class="va">loggamma.expression</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="va">loggamma</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#BATSS using normal priors with N(1,4) for the fixed effect of intervention T1 and </span></span>
<span><span class="co">#the intercept and N(0,4) for intervention T2 and all other fixed effects and a </span></span>
<span><span class="co">#user-defined log-gamma(0.5,0.01) prior for the log precision hyperparameter.</span></span>
<span><span class="va">sim6</span> <span class="op">=</span> <span class="fu"><a href="../../reference/batss.glm.html">batss.glm</a></span><span class="op">(</span>  </span>
<span>          model             <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">trt</span>,   </span>
<span>          var               <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y   <span class="op">=</span> <span class="va">rnorm</span>,</span>
<span>                                   trt <span class="op">=</span> <span class="va">group.fun</span><span class="op">)</span>,</span>
<span>          var.control       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          beta              <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>          which             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>          R                 <span class="op">=</span> <span class="fl">10</span>,</span>
<span>          N                 <span class="op">=</span> <span class="fl">200</span>,</span>
<span>          interim           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>recruited<span class="op">=</span><span class="fl">100</span><span class="op">)</span>,</span>
<span>          prob0             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>C<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, T1<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, T2<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>          eff.arm           <span class="op">=</span> <span class="va">efficacy.fun</span>,</span>
<span>          eff.arm.control   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>efficacy.bound <span class="op">=</span> <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>          delta.eff         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>          fut.arm           <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>          computation       <span class="op">=</span> <span class="st">"parallel"</span>,</span>
<span>          H0                <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          mc.cores          <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span>,</span>
<span>          control.fixed     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean.intercept<span class="op">=</span><span class="fl">1</span>,</span>
<span>                                   prec.intercept<span class="op">=</span><span class="fl">0.25</span>,</span>
<span>                                   mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trtT1 <span class="op">=</span> <span class="fl">1</span>, default <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, </span>
<span>                                   prec <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>          control.family    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>hyper <span class="op">=</span> <span class="va">loggamma.expression</span><span class="op">)</span></span>
<span>          <span class="op">)</span> </span>
<span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">sim6</span><span class="op">$</span><span class="va">H1</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span>,<span class="fl">3</span>,<span class="op">]</span>,<span class="fl">1</span>,<span class="va">summary</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#check if it matches the predefined loggamma prior</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">sim3</span><span class="op">$</span><span class="va">H1</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span>,<span class="fl">3</span>,<span class="op">]</span>,<span class="fl">1</span>,<span class="va">summary</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="further-reading">Further reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h2>
<p>Further details (including parametrisation of distributions) and
examples for use of priors in <code>INLA</code> (and by extension in
<code>BATSS</code>) can be found in the INLA documentation
<code>inla.doc("[TOPIC]")</code> or online (<a href="https://www.r-inla.org/" class="external-link uri">https://www.r-inla.org/</a>).</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-HR2009" class="csl-entry">
Rue, Håvard, Sara Martino, and Nicolas Chopin. 2009. <span>“Approximate
Bayesian Inference for Latent Gaussian Models by Using Integrated Nested
Laplace Approximations.”</span> <em>Journal of the Royal Statistical
Society: Series B (Statistical Methodology)</em> 71 (2): 319–92. <a href="https://doi.org/10.1111/j.1467-9868.2008.00700.x" class="external-link">https://doi.org/10.1111/j.1467-9868.2008.00700.x</a>.
</div>
<div id="ref-DS2017" class="csl-entry">
Simpson, Daniel, Håvard Rue, Andrea Riebler, Thiago G. Martins, and
Sigrunn H. Sørbye. 2017. <span>“<span class="nocase">Penalising Model
Component Complexity: A Principled, Practical Approach to Constructing
Priors</span>.”</span> <em>Statistical Science</em> 32 (1): 1–28. <a href="https://doi.org/10.1214/16-STS576" class="external-link">https://doi.org/10.1214/16-STS576</a>.
</div>
<div id="ref-JVN2023" class="csl-entry">
Van Niekerk, Janet, Elias Krainski, Denis Rustand, and Håvard Rue. 2023.
<span>“A New Avenue for Bayesian Inference with INLA.”</span>
<em>Computational Statistics &amp; Data Analysis</em> 181: 107692. <a href="https://doi.org/10.1016/j.csda.2023.107692" class="external-link">https://doi.org/10.1016/j.csda.2023.107692</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dominique-Laurent Couturier, Liz Ryan, Rainer Puhr, Thomas Jaki, Stephane Heritier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
